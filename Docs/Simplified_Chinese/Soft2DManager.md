# Soft2DManager
Soft2DManager 是核心的场景管理器，它负责管理场景的参数配置、渲染和管理各个物体（body、collider 和 trigger）。场景里必须放置一个 Soft2DManager 才能使用插件的相关功能。对应代码中的 `Soft2DManager` 类型。

## 参数面板
Soft2DManager 的参数面板分为渲染设置、world 设置、调试工具设置、最大值设置、分辨率设置和碰撞设置六个部分。

### World 设置
World 是一个容器，它包含一个场景中与模拟相关的所有物体，并按照物理规则对这些物体进行物理模拟。

- 世界区域大小
  - 物理模拟的区域大小。
- 世界偏移坐标
  - 物理模拟区域左下角的位置坐标。
- 重力
  - 场景中重力的大小和方向。仅在关闭陀螺仪后有效。
- 陀螺仪
  - 是否打开陀螺仪。
- 陀螺仪重力缩放系数
  - 陀螺仪重力的缩放系数。仅在开启陀螺仪后有效。
- 力场
  - 是否开启力场。用户拖动光标时，会在光标周围产生一个影响粒子的作用力，作用力的方向为光标的移动方向。
- 力场力大小
  - 力场内作用力的大小。仅在开启力场后有效。
- 世界边界
  - 是否开启边界。开启世界边界会自动在模拟范围的边界生成 collider 阻止粒子超过模拟范围。

### 调试工具设置
- 开启调试工具
  - 是否开启调试工具。开启此选项能够在运行时可视化出 collider 和 trigger 的位置。
- Collider 颜色
  - Collider 的可视化颜色。
- Trigger 颜色
  - Trigger 的可视化颜色。

### 渲染设置
- 粒子模型
  - 渲染每个粒子所使用的模型。
- 粒子渲染层级
  - 渲染粒子的渲染层级。
- 粒子渲染模式。用于渲染粒子的渲染材质。Soft2D-for-Unity 内置了三种类型的模式，并支持用户自定义渲染模式。我们目前支持以下几种渲染模式：
  - `Unlit`：只显示颜色，没有光照效果。
  - `Blinn-Phong`：Blinn-Phong 光照模型，仅支持 URP 管线。
  - `PBR`：PBR 光照模型，仅支持 URP 管线。
  - `Custom`：用户自定义渲染模式。详细介绍见[自定义着色器](./CustomShader.md)。

### 时间设置
- 时间步长
  - 物理模拟的时间步长。
- 时间子步长
  - 当前时间步长的内部时间子步长。

### 最大值设置
- 最大粒子数量
  - 当前场景允许的最大粒子数量。
- 最大 body 数量
  - 当前场景允许的最大 body 数量。
- 最大 Trigger 数量
  - 当前场景允许的最大 trigger 数量。

### 分辨率设置

- 网格分辨率：场景背景网格的分辨率大小。这个数值影响物理模拟的精细程度。
- 精细网格缩放系数：精细网格的分辨率与场景背景网格的比例。这个数值影响 collider 和 trigger 的精细程度。

### 碰撞设置
- 法线碰撞力度：粒子沿着 collider 法线方向的碰撞衰减力度。
- 速度碰撞力度：粒子沿着粒子速度方向的碰撞衰减力度。
- Mesh body 内力缩放系数：Mesh body 内部受力的缩放系数。

## FAQ
如何在一个大规模的世界中模拟很小的物体？

- 在 Soft2D-for-Unity 中，body 中粒子的采样密度会根据世界的大小来自动调整，更大的世界会导致更稀疏的粒子采样。因此，在一个较大的世界中可能没有足够的精度来模拟非常小的物体。

是否可以为不同的粒子设置不同的渲染材质。

- 目前粒子通过`Graphics.DrawMeshInstancedIndirect`方法绘制，暂时不支持为不同的粒子设置不同的材质。
